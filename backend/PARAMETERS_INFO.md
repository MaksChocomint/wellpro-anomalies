# WellPro - Описание параметров буровых данных

## Обзор программы

**WellPro** - система интеллектуального мониторинга и детектирования аномалий буровых данных в реальном времени. Система использует три метода анализа (FFT, Z-score, LOF) для выявления отклонений от нормального поведения параметров.

### Архитектура

- **Backend**: FastAPI с WebSocket поддержкой для реального времени
- **Frontend**: Next.js с интерактивными графиками (Plotly)
- **Анализ**: Асинхронный обработка данных с использованием окно-ориентированного подхода

---

## Параметры буровых данных (12 ключевых параметров)

### 1. **Глубина** (Depth)

- **Описание**: Текущая глубина скважины в метрах
- **Нормальное поведение**: Монотонный рост во время бурения, постоянное значение при остановке
- **Инерционность**: Очень высокая (медленное, плавное изменение - максимум несколько метров в минуту)
- **Допустимые резкие изменения**: Отсутствуют. Скачок > 10м за один цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - Увеличивается → увеличение скорости бурения, момента ротора, нагрузки
  - Остановка → параметры должны стабилизироваться

---

### 2. **Скорость бурения** (Drilling_Rate)

- **Описание**: Скорость углубления скважины (м/ч)
- **Нормальное поведение**: 40-150 м/ч для типичных условий, плавное колебание
- **Инерционность**: Высокая (изменяется в течение нескольких минут)
- **Допустимые резкие изменения**: ±20% за 1 минуту допустимо, > ±50% за 1 мин - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↑ Скорость бурения → ↑ Глубина, ↑ Нагрузка, ↓ Обороты ротора (обратная связь)
  - При ↓ Скорости < 5 м/ч → проверить вес на крюке и момент ротора

---

### 3. **Вес на крюке** (Hook_Load)

- **Описание**: Вес колонны на крюке буровой установки (тонны)
- **Нормальное поведение**: 200-600 тонн, зависит от конструкции БУ и колонны
- **Инерционность**: Средняя (плавное изменение при добавлении/удалении труб)
- **Допустимые резкие изменения**: ±50 тонн допустимо, > ±100 тонн за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - Увеличение при добавлении новой трубы (нормально)
  - Резкое ↓ вес на крюке + ↓ момент ротора → возможен обрыв колонны - КРИТИЧНО
  - Коррелирует с нагрузкой и глубиной

---

### 4. **Момент ротора** (Torque)

- **Описание**: Момент сопротивления вращению ротора (кНм)
- **Нормальное поведение**: 150-450 кНм в зависимости от типа пород
- **Инерционность**: Низкая (может меняться резко при встрече с плотными породами)
- **Допустимые резкие изменения**: ±100 кНм допустимо, > ±200 кНм за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↑ Момент + ↑ Обороты → перегрев, возможен захват ротора
  - Высокий момент при ↓ скорости бурения → упорная ситуация (stuck situation)
  - При ↓ веса на крюке + ↑ момента → риск потери контроля

---

### 5. **Обороты ротора** (RPM)

- **Описание**: Частота вращения ротора (об/мин)
- **Нормальное поведение**: 50-150 об/мин, может быть пульсирующим
- **Инерционность**: Низкая (может скачком меняться при управлении)
- **Допустимые резкие изменения**: ±30 об/мин допустимо, > ±50 об/мин за цикл - ВНИМАНИЕ
- **Связь с другими параметрами**:
  - ↑ Обороты + ↑ Момент → риск перегрева ротора
  - Обратная связь со скоростью бурения (при ↑ Оборотов → ↓ Скорость)
  - Низкие обороты + высокий момент → застревание

---

### 6. **Давление на входе** (Inlet_Pressure)

- **Описание**: Давление бурового раствора на входе в бурильную колонну (бар)
- **Нормальное поведение**: 80-200 бар, плавное поведение
- **Инерционность**: Средняя (зависит от вязкости раствора и характеристик насоса)
- **Допустимые резкие изменения**: ±15 бар допустимо, > ±30 бар за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - Коррелирует с расходом на входе
  - ↑ Давление + ↓ Расход → возможна закупорка системы - КРИТИЧНО
  - Скачок давления → воздух в системе или утечка

---

### 7. **Расход на входе** (Flow_In)

- **Описание**: Объёмный расход бурового раствора на входе (л/мин)
- **Нормальное поведение**: 600-1200 л/мин, зависит от типа насоса и раствора
- **Инерционность**: Низкая (может меняться быстро при управлении)
- **Допустимые резкие изменения**: ±50 л/мин допустимо, > ±100 л/мин за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↑ Расход → улучшение выноса шлама, ↑ давление на входе
  - ↓ Расход при ↑ давлении → закупорка - КРИТИЧНО
  - Баланс с расходом на выходе критичен для контроля вытеснения

---

### 8. **Температура на выходе** (Outlet_Temperature)

- **Описание**: Температура бурового раствора на выходе из скважины (°C)
- **Нормальное поведение**: 30-60°C, медленное увеличение при циркуляции
- **Инерционность**: Очень высокая (температура меняется медленно, инерция теплопередачи)
- **Допустимые резкие изменения**: ±5°C допустимо, > ±10°C за цикл - ВНИМАНИЕ
- **Связь с другими параметрами**:
  - ↑ Температура при ↑ трении (↑ момента, ↑ оборотов) → нормально, но контролировать
  - Резкий ↑ температуры → возможен захват ротора или затопление
  - Скачок температуры > 15°C → кипение/испарение раствора - КРИТИЧНО

---

### 9. **Уровень в емкости** (Tank_Level)

- **Описание**: Уровень бурового раствора в емкости (%)
- **Нормальное поведение**: 85-100%, плавное снижение при циркуляции
- **Инерционность**: Средняя (зависит от расхода и объёма емкости)
- **Допустимые резкие изменения**: ±5% допустимо, > ±10% за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↓ Уровень + ↑ Давление на входе → утечка раствора - КРИТИЧНО
  - Критический уровень < 70% → остановить работу (нет охлаждения)
  - Связан с расходом: ↑ расход → ↓ уровень быстрее

---

### 10. **Скорость СПО** (ROP_SPO - Rate of Penetration Secondary)

- **Описание**: Альтернативный расчёт скорости проникновения (м/ч)
- **Нормальное поведение**: 30-100 м/ч, коррелирует с основной скоростью бурения
- **Инерционность**: Высокая (сглаженное значение скорости бурения)
- **Допустимые резкие изменения**: ±15% допустимо, > ±30% за 1 мин - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - Должна быть близка к основной скорости бурения (Глубина)
  - Расхождение > 20% → ошибка датчика - проверить
  - Низкая корреляция с мощностью → неисправность системы

---

### 11. **Нагрузка** (Weight_On_Bit - WOB)

- **Описание**: Нагрузка на долото (тонны)
- **Нормальное поведение**: 50-300 тонн, плавное изменение
- **Инерционность**: Высокая (плавное увеличение при углублении)
- **Допустимые резкие изменения**: ±20 тонн допустимо, > ±50 тонн за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↑ Нагрузка → ↑ скорость бурения (до оптимума)
  - Максимальная нагрузка зависит от типа долота и пород
  - ↑ Нагрузка + ↑ Момент → риск захвата - КРИТИЧНО
  - Низкая нагрузка + низкая скорость → неэффективная работа

---

### 12. **ДМК** (DMK - Differential Mud Cake)

- **Описание**: Толщина фильтрационной корки на стенке скважины (мм)
- **Нормальное поведение**: 0.5-2 мм, очень медленный рост
- **Инерционность**: Очень высокая (кумулятивный параметр, растёт медленно)
- **Допустимые резкие изменения**: Скачок > 1 мм за цикл - АНОМАЛИЯ
- **Связь с другими параметрами**:
  - ↑ ДМК → ↑ адгезия, риск прилипания → ↓ скорость бурения
  - Связан с составом раствора и давлением
  - При ↑ ДМК требуется промывка скважины
  - Резкое ↑ ДМК → изменение литологии или проблема с раствором - ВНИМАНИЕ

---

## Методы анализа

### 1. FFT (Fast Fourier Transform)

- **Принцип**: Анализ частотных компонентов в окне данных
- **Используется для**: Обнаружение вибраций, затопления, захватов ротора
- **Порог**: 0.3 (отношение высокочастотных компонентов)
- **Окно**: 64 точки

### 2. Z-score

- **Принцип**: Статистическое отклонение от среднего за окно
- **Используется для**: Обнаружение локальных выбросов и резких скачков
- **Порог**: 3 (сигма)
- **Окно**: 50 точек

### 3. LOF (Local Outlier Factor)

- **Принцип**: Локальная плотность при сравнении с соседями
- **Используется для**: Обнаружение аномалий контекста (не очень высокие, но необычные)
- **Порог**: 25
- **Окно**: 50 точек

---

## Логика обнаружения аномалий

**Аномалия фиксируется когда:**

1. Значение выходит за пределы допустимого диапазона
2. Скорость изменения превышает допустимую
3. Параметр резко отклоняется от исторической норму (Z-score)
4. Параметр ведёт себя аномально в контексте соседних значений (LOF)
5. Возникает нетипичная частотная характеристика (FFT)

**Критичные комбинации аномалий:**

- ↓ Вес на крюке + ↓ Момент ротора → обрыв колонны
- ↑ Давление на входе + ↓ Расход на входе → закупорка системы
- ↑ Момент ротора + ↑ Температура + ↑ Обороты → захват ротора
- ↓ Уровень в емкости + ↓ Расход → утечка раствора
- Резкие скачки нескольких параметров одновременно → неисправность датчика

---

## Рекомендации по мониторингу

### Нормальная работа

- Все параметры в допустимых диапазонах
- Гладкие кривые без резких скачков
- Логичные корреляции между параметрами

### Требуется внимание

- Один параметр на границе диапазона
- Медленный тренд в одну сторону
- Необычная, но не критичная комбинация

### Критичная ситуация

- Несколько параметров выходят за пределы одновременно
- Резкие скачки на критичные значения
- Невозможные комбинации параметров (противоречие физическим законам)
